<!DOCTYPE html>

<html lang="en">

    <head>

        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1, width=device-width">

        <link href="images/joker.png" rel="icon">

        <link href="styles.css" rel="stylesheet">

        <title>Deuces Wild</title>

        <script src="script.js" type="module"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>

        <div id="heading" class="heading">
            <h2>Welcome to Deuces Wild</h2>
        </div>

        <div class="instructions">
            <div id="beginner" class="beginner" data-html="true" data-tooltip="Are you ready to become a great Deuces Wild player? Maybe the best ever? Wait... you're saying you've never played before? Ah don't worry, I got you covered. We'll go through basic gameplay first, then talk strategy.&#xa; 
            1. Hit 'enter' to start the first round. You'll be dealt 5 random cards. &#xa;
            2. Select which ones to hold and which ones to fold (get rid of). Click the cards with either your mouse or the '1' to '5' keys. Gold cards are the ones you choose to hold.&#xa;
            3. Hit 'enter' again to lock in your choice. New cards from the remaining deck will replace non-gold cards.&#xa;
            4. Each hand costs one point to play. Payouts for qualifying hands will earn you points. See those qualifying hands on the table to the left.&#xa;
            5. Check our your metrics on the bottom right to see if you got lucky, if you made the best decision, and to see how strong your starting hand was. Also, check out the graph on the top right for a visual of overall performance.&#xa;
            6. Hit 'enter' again to start up the next round with a fresh deck!&#xa;
            Which ones should you hold and which ones should you fold? Put your cursor over the table on the left for a guide. Also hover over the 'Solver Details' button for a cheat sheet. Pro tip:&#xa;
            A. Deuces count as 'wild cards', hence the name of the game. They count for any card and any suit that best improves your hand. You'll always want to hold those!&#xa;
            B. If you want to see multiple iterations of your decision, enable the 'Extra Hands' button below">Cursor here if you're new</div>
            
            <div id ="non_beginner" class="non_beginner" data-html="true" data-tooltip="Instructions below:&#xa;
            1. Hit the 'enter' key to start the round, lock in your hand, and start the following round.&#xa;
            2. To select what to hold/fold, click on the cards with your mouse or use the '1' to '5' keys. The gold cards will be held. &#xa;
            3. Hit the 's' key to activate the solver mid-round.&#xa;
            4. Enable 'Extra Hands' for 8 more iterations.&#xa;
            5. Graph on the right shows your: expected score given you make the best decision, luck metric with gold dots compared to actual EV, and actual score. The bars represent the round scores.">Cursor here if you're not</div>
        </div>

    </head>

    <body>

        <div class="top_container">

            <div id="table_container" class="table_container" data-html="true" data-tooltip="Hopefully you're familiar with poker hands. If not, go ahead and search search those up and come back here straight away.&#xa;
            On the very left, you have all the different hands you can make. We've then added a few bonus hands into the mix. These are: (1) FOUR DEUCES i.e. the 4 jokers and (2) WILD ROYAL FLUSH which is a royal flush that contains one or more wild cards. Not all of these hands get rewarded. In the second column of the table we have the payouts for making each of these hands, all the way from 800 points for a NATURAL ROYAL FLUSH to 0 points for a hand with just a HIGH CARD.&#xa;
            You should be aware that each hand you lock in, a total of 9 each round, will cost you one point! That means your hand needs to at least be as strong as a THREE OF A KIND to breakeven. Anything lower than that will cost you one point, but anything better is pure profit! Other notes:&#xa;
            - Column 3 contains a tracker for the total number of times you have made each hand. At the very beginning of the game it will be all zeroes since you haven't made anything yet.&#xa;
            - Column 4 contains a hidden indicator for how many of each hand type you made in the current round. Note: This will only show up, in bright yellow text, when a round is over.">

                <table>
                    <tbody>
                        <tr>
                            <td>NATURAL ROYAL FLUSH</td>
                            <td>800</td>
                            <td id="nat_rf">0</td>
                            <td id="inc_nat_rf" class="increment">0</td>
                        </tr>
                        <tr>
                            <td>FOUR DEUCES</td>
                            <td>200</td>
                            <td id="four_d">0</td>
                            <td id="inc_four_d" class="increment">0</td>
                        </tr>
                        <tr>
                            <td>WILD ROYAL FLUSH</td>
                            <td>25</td>
                            <td id="wild_rf">0</td>
                            <td id="inc_wild_rf" class="increment">0</td>
                        </tr>
                        <tr>
                            <td>FIVE OF A KIND</td>
                            <td>15</td>
                            <td id="fives">0</td>
                            <td id="inc_fives" class="increment">0</td>
                        </tr>
                        <tr>
                            <td>STRAIGHT FLUSH</td>
                            <td>9</td>
                            <td id="sf">0</td>
                            <td id="inc_sf" class="increment">0</td>
                        </tr>
                        <tr>
                            <td>FOUR OF A KIND</td>
                            <td>5</td>
                            <td id="quads">0</td>
                            <td id="inc_quads" class="increment">0</td>
                        </tr>
                        <tr>
                            <td>FULL HOUSE</td>
                            <td>3</td>
                            <td id="boat">0</td>
                            <td id="inc_boat" class="increment">0</td>
                        </tr>
                        <tr>
                            <td>FLUSH</td>
                            <td>2</td>
                            <td id="fl">0</td>
                            <td id="inc_fl" class="increment">0</td>
                        </tr>
                        <tr>
                            <td>STRAIGHT</td>
                            <td>2</td>
                            <td id="str">0</td>
                            <td id="inc_str" class="increment">0</td>
                        </tr>
                        <tr>
                            <td>THREE OF A KIND</td>
                            <td>1</td>
                            <td id="trips">0</td>
                            <td id="inc_trips" class="increment">0</td>
                        </tr>
                        <tr>
                            <td>TWO PAIRS</td>
                            <td>0</td>
                            <td id="two_p">0</td>
                            <td id="inc_two_p" class="increment">0</td>
                        </tr>
                        <tr>
                            <td>ONE PAIR</td>
                            <td>0</td>
                            <td id="one_p">0</td>
                            <td id="inc_one_p" class="increment">0</td>
                        </tr>
                        <tr>
                            <td>HIGH CARD</td>
                            <td>0</td>
                            <td id="hc">0</td>
                            <td id="inc_hc" class="increment">0</td>
                        </tr>
                    </tbody>
                </table>

            </div>

            <div class="swappable_section">

                <div id="solver_section" class="solver_section">
                    <div class="solver_hand0 solver_hand" id="solver_hand0"></div>
                    <div class="solver_hand1 solver_hand" id="solver_hand1"></div>
                    <div class="solver_hand2 solver_hand" id="solver_hand2"></div>
                    <div class="solver_hand3 solver_hand" id="solver_hand3"></div>
                    <div class="solver_hand4 solver_hand" id="solver_hand4"></div>
                </div>

                <div class="extra_hand_area" id="extra_hands">
                    <div class="extra_hand0 extra_hand"><div id="hand_type0" class="hand_type_extra"></div></div>
                    <div class="extra_hand1 extra_hand"><div id="hand_type1" class="hand_type_extra"></div></div>
                    <div class="extra_hand2 extra_hand"><div id="hand_type2" class="hand_type_extra"></div></div>
                    <div class="extra_hand3 extra_hand"><div id="hand_type3" class="hand_type_extra"></div></div>
                    <div class="extra_hand4 extra_hand"><div id="hand_type4" class="hand_type_extra"></div></div>
                    <div class="extra_hand5 extra_hand"><div id="hand_type5" class="hand_type_extra"></div></div>
                    <div class="extra_hand6 extra_hand"><div id="hand_type6" class="hand_type_extra"></div></div>
                    <div class="extra_hand7 extra_hand"><div id="hand_type7" class="hand_type_extra"></div></div>
                </div>

            </div>


            <div id="graph_container" class="graph_container" data-html="true" data-tooltip="1. Red and green bars represent your score each round. No bar means you scored 0 points.&#xa;
            2. Your total score from all previous rounds will be tracked by the white line. Hover over the right most point on it to see your current score.&#xa;
            3. When the solver feature is turned on, two extra lines will begin to populate the graph:&#xa;
            -  a yellow line will track your EXPECTED score given you make the BEST decision each round. Differences between this line and your actual score can be explained by a combination of not making the best choices and/or by luck.&#xa;
            - a pink line will track your EXPECTED score given the ACTUAL decisions you made. Differences between this line and your actual score are purely driven by luck!&#xa;
            Tip: if the white and pink lines are really close, but the white and yellow aren't, that means you have room to make better decisions.">

                <div id="chart_container" class="chart_container">
                    <canvas id="myChart" width="100" height="80"></canvas>
                    <script>
                        const ctx = document.getElementById('myChart').getContext('2d');
                        const myChart = new Chart(ctx, {
                            data: {
                                labels: [0],
                                datasets: [{
                                    label: 'Current Total',
                                    type: 'line',
                                    data: [0],
                                    borderColor: ['white'],
                                    borderWidth: 1
                                },
                                {
                                    label: 'Round Score',
                                    type: 'bar',
                                    data: [0],
                                    borderColor: ['rgba(255, 99, 132, 0.2)'],
                                    backgroundColor: ['rgb(255, 99, 132)'],
                                    borderWidth: 1,
                                    borderSkipped: false
                                },
                                {
                                    label: 'Expected Total',
                                    type: 'line',
                                    data: [0],
                                    borderColor: ['rgb(255,105,180)'],
                                    borderWidth: 1
                                },
                                {
                                    label: 'Actual Luck',
                                    type: 'scatter',
                                    data: [0],
                                    borderColor: ['gold'],
                                    borderWidth: 1
                                }
                                ]
                            },
                            options: {
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        suggestedMin: -5,
                                        suggestedMax: 5,
                                        title: {
                                            display: true,
                                            text: "Score"
                                        }
                                    },
                                    x: {
                                        title: {
                                            display: true,
                                            text: "# of Rounds Played"
                                        }
                                    }
                                },
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                }
                            }
                        });
                    </script>

                </div>
            </div>


        </div>

        <div class="game_area" id="game_area">

            <div class="game_settings">
                <!--Tooltip switch, solver switch, solver button, background music, ard flipping music -->

                <!-- Music plays when user starts Round 1-->
                <audio id="music_player" autoplay loop>
                    <source src="elevator_music.mp3" type="audio/mpeg"/>
                </audio>

                <!-- Solver enable/disable option-->

                <div id="solver_switch" class="solver_switch" data-html="true" data-tooltip="Click the 's' key to activate me in the middle of a round i.e. initial hand has been dealt, but not locked in yet.&#xa;
                The solver will display the top 5 hold/fold combinations in order from best to worst. White cards are to be held, grey cards are to be discarded. The 6 columns of numbers to the right of each hand combinations are:&#xa;
                1. EV = the expected value. This number represents the average payout given all the combination of cards that can fill the empty slots. It doesn't account for cost. This means that any EV less than 1 is expected to lose you points on average.&#xa;
                2. P(win) = the probability that you will make a qualifying hand i.e. it scores more than 0 points.&#xa;
                3. P(SF+) = the probability that your hand will be a straight flush or better in the payout scale.&#xa;
                The last 3 columns represent the TOP 3 most likely hands you will make that earn a payout of at least 1.&#xa;
                For example, say these last 3 columns were: P(Trips) = 30, P(Str.) = 10 and P(Quads) = 8. That means that the most likely qualifying hand ythat you will make is be a THREE OF A KIND. You will make this hand 30% of the time. The next likely hand you will make is a STRAIGHT with a 10% likelihood. The third most likely hand you make is a FOUR OF A KIND with an 8% likelihood.">Solver Details</div>
                <div id="instructions_switch" class="instructions_switch">Instructions Enabled</div>

                <!-- Extra Hands enable/disable option-->

                <div id="extra_hands_switch" class="extra_hands_switch">Extra Hands Disabled</div>
                <div id="music_volume_switch" class="music_volume_switch">Music Enabled</div>
                <div id="poker_hands_view" class="poker_hands_view">View Poker Hands</div>

            </div>

            <div class="main_hand" id="main_hand">

                <div class="hand_type" id="hand_type"></div>
                <div class="player_slot0 slot"></div>
                <div class="player_slot1 slot"></div>
                <div class="player_slot2 slot"></div>
                <div class="player_slot3 slot"></div>
                <div class="player_slot4 slot"></div>
            
                <script>

                    document.addEventListener('keydown', keyfunction);

                    function clickfunction(id){
                        const x = document.getElementById(id);  
                        const card_elements = window.getComputedStyle(x);

                        if (x.classList.contains("unclickable")) {
                            return
                        } else if (card_elements.backgroundColor == "rgb(255, 255, 255)") {
                            x.style.backgroundColor = "gold";
                        } else {
                            x.style.backgroundColor = "white";
                        }
                    }

                    function keyfunction(event) {
                        var x = event.key;

                        for (let i = 0; i < 5; i++) {
                            var id_num = x-1;
                            var key_id = "card"+id_num;
                            if (key_id == "card"+i) {
                                clickfunction(key_id);
                            }
                        }
                    }  

                </script>

            </div>

            <div class="dead_space">

                <div id="round_indicator" class="round_indicator">Round: 0</div>
                <div id="best_decision_streak" class="best_decision_streak">Streak of #1 Option: 0</div>
                <div id="initial_luck" class="initial_luck">Starting Hand Rank: tbd</div>
                <div id="final_luck" class="final_luck">Last Outcome: tbd</div>
                <div id="perc_best_decision" class="perc_best_decision">Best Decision: tbd</div>

            </div>

        </div>

    </body>

</html>
